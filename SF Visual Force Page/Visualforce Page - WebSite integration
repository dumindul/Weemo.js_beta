<link rel="stylesheet" type="text/css" href="https://demo.weemo.com/css/demosalesforce.css"></link>
<script type='text/javascript' src='https://demo.weemo.com/js/dragNdrop.js'></script>
<script src="https://download.weemo.com/js/webappid/MyAppIdentifier" type="text/javascript"></script>
<script type='text/javascript'>
    var WebAppIdentifier = "MyAppIdentifier";

    function randomString(length, chars) {
        var result = '';
        for (var i = length; i > 0; --i){
          result += chars[Math.round(Math.random() * (chars.length - 1))];
        }
        return result;
    }

    var uidGuest = randomString(6, 'abcdefghijklmnopqrstuvwxyz');
    var weemo = new Weemo(WebAppIdentifier,uidGuest,"internal",'', '1', 'Visitor'); 

    weemo.onConnectionHandler = function(message, code) {
        if(window.console)
            console.log("Connection Handler : " + message + ' ' + code);
        switch(message) {
            case 'connectedWebRTC':
                weemo.authenticate();
                break;
            case 'sipOk':
                break;
        }
    }

    weemo.onCallHandler = function(callObj, args) {
        if(args.type == 'webRTCcall' && args.status == 'incoming') {
            var confirmStr;
            if(callObj.dn !== "undefined" && callObj.dn !== undefined) {
                confirmStr = callObj.dn + ' invites you to video chat';
            } else {
                confirmStr = 'A person invites you to video chat';
            }
            if (confirm(confirmStr)) {
                callObj.accept();
            } else {
                callObj.hangup();
            }
        }
        if(args.type == 'webRTCcall' && args.status == 'active') {
            // Active drag and drop function
            var rv = document.getElementById('weemo-remotevideo');
            rv.addEventListener('mousedown', dragg.startMoving, false);
            var sv = document.getElementById('weemo-selfview');
            sv.addEventListener('mousedown', dragg.startMovingPIP, false);
            
            window.addEventListener('mouseup', dragg.stopMoving, false);
        }
    };
        
    weemo.initialize();
    liveagent.addCustomDetail('visitorUid',uidGuest,true);
</script>
